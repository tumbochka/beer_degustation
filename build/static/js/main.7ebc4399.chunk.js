(this.webpackJsonpbeer_degustation=this.webpackJsonpbeer_degustation||[]).push([[0],{1024:function(e,t){},1138:function(e,t){},1277:function(e,t,a){},1278:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(67),c=a.n(l),o=a(5),u=a.n(o),s=a(40),i=a(20),b=a(269);a(383),a(676),a(677),a(678);b.initializeApp({apiKey:"AIzaSyDs42kUWGtEpwneo0cAUAGi8lUKpVD3Iik",authDomain:"beer-degustation.firebaseapp.com",databaseURL:"https://beer-degustation.firebaseio.com",projectId:"beer-degustation",storageBucket:"beer-degustation.appspot.com",appId:"1:1058720130453:web:7dc1000cd81db0be68829c"});var m=b.auth(),d=b.firestore();d.enablePersistence().catch((function(e){"failed-precondition"===e.code?console.log("persistance failed"):"unimplemented"===e.code&&console.log("persistance not available")}));var p,f=a(56),E=a(47),g=a.n(E),h=new E.auth.GoogleAuthProvider,v=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],l=t[1];return r.a.createElement("div",{className:"mt-8"},r.a.createElement("h1",{className:"text-3xl mb-2 text-center font-bold"},"Sign In"),r.a.createElement("div",{className:"border border-blue-400 mx-auto w-11/12 md:w-2/4 rounded py-8 px-4 md:px-8"},null!==a&&r.a.createElement("div",{className:"py-4 bg-red-600 w-full text-white text-center mb-3"},a),r.a.createElement("button",{className:"bg-red-500 hover:bg-red-600 w-full py-2 text-white",onClick:function(){try{m.signInWithPopup(h)}catch(e){l(e.message)}}},"Sign in with Google")))},O=a(658),j=a(41),w={apiUrl:window.location.origin,untappdApiUrl:"https://api.untappd.com/v4/",untappdAuthenticateUrl:"https://untappd.com/oauth/authenticate/",untappdAuthorizeUrl:"https://untappd.com/oauth/authorize/",untappdClientId:"21A86E4A8453F99FAEA02AB681E869114EE6F52C",untappdClitntSecret:"F5B38868AE44D884D7FF063807C144CFBB906A89",googleClientId:"1058720130453-2pnheomg9dit4ssmseqg0s1jm8irjccq.apps.googleusercontent.com",googleDeveloperKey:"AIzaSyDarcYoo3NdqNICcGj-5rmyEN-aXj8W714",googleServiceAccountEmail:"degustator@beer-degustation.iam.gserviceaccount.com",googleServiceAccountKey:"108471438581247733762"},y=a(29),C=function(){var e=Object(s.a)(u.a.mark((function e(t,a){var n,r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=d.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=16;break}return r=t.email,l=t.photoURL,e.prev=8,e.next=11,n.set(Object(y.a)({email:r,photoURL:l},a));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user",e.t0);case 16:return e.abrupt("return",_(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,a){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(u.a.mark((function e(t,a){var n,r,l,c,o,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=d.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(!e.sent.exists){e.next=16;break}return r=t.firstName,l=t.lastName,c=t.email,o=t.photoURL,s=t.untappdName,i=t.untappdAccessToken,e.prev=8,e.next=11,n.update(Object(y.a)({firstName:r,lastName:l,email:c,photoURL:o,untappdName:s,untappdAccessToken:i},a));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error updating user",e.t0);case 16:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,a){return e.apply(this,arguments)}}(),_=function(){var e=Object(s.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,d.doc("users/".concat(t)).get();case 5:return a=e.sent,e.abrupt("return",Object(y.a)({uid:t},a.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.collection("degustations").get();case 3:return t=e.sent,e.abrupt("return",t.docs.map((function(e){return Object(y.a)(Object(y.a)({},e.data()),{id:e.id})})));case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching degustations",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.a.functions().httpsCallable("updateClientDegustation"),console.log("updating",t),e.prev=2,e.next=5,a({degustation:t});case 5:return n=e.sent,e.abrupt("return",n.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.error("Error updating degustation",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(s.a)(u.a.mark((function e(t,a,n,r){var l,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=g.a.functions().httpsCallable("createDegustation"),e.prev=1,e.next=4,l(t,a,n,r);case 4:return c=e.sent,e.abrupt("return",c.data);case 8:throw e.prev=8,e.t0=e.catch(1),console.error("Error creating degustation",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),D=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.doc("degustations/".concat(t)),e.prev=1,e.next=4,a.get();case 4:return n=e.sent,e.abrupt("return",n.data());case 8:e.prev=8,e.t0=e.catch(1),console.error("Error updating degustation",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),I=a(1289),U=a(1290),A=a(660),L=a(1294),B=function(e){var t,a=Object(n.useState)(!1),r=Object(i.a)(a,2),l=r[0],c=r[1],o=Object(n.useState)(null),u=Object(i.a)(o,2),s=u[0],b=u[1],d=e.user,E=d.photoURL,h=d.firstName,v=d.lastName,y=d.untappdName,C=d.email,_=d.photoUrl,k=e.code;t=_||(E||"https://res.cloudinary.com/dqcsk8rsc/image/upload/v1577268053/avatar-1-bitmoji_upgwhc.png");return k&&!l&&(c(!0),function(e,t){var a=g.a.functions().httpsCallable("untappdAuthorize"),n=window.location.protocol+"//"+window.location.host+"/callback";a({url:w.untappdAuthorizeUrl,clientId:w.untappdClientId,clientSecret:w.untappdClitntSecret,redirectUrl:n,code:e}).then((function(e){var a=JSON.parse(e.data).response.access_token,n=w.untappdApiUrl+"user/info/";g.a.functions().httpsCallable("untappdFetchUserDetails")({url:n,accessToken:a}).then((function(e){var n=JSON.parse(e.data).response.user;t({untappdEmail:n.settings.email_address,lastName:n.last_name,firstName:n.first_name,photoUrl:n.user_avatar_hd,untappdName:n.user_name,untappdAccessToken:a})})).catch((function(e){console.log("auth error"),t({error:e.message})}))})).catch((function(e){console.log("auth error"),t({error:e.message})}))}(k,(function(t){t.error?b(t.error):N(e.user,t),c(!1)}))),Object(j.b)("div",null,null!==s&&Object(j.b)("div",null,s),Object(j.b)(I.a,null,Object(j.b)(U.a,null,Object(j.b)(A.a,null,Object(j.b)("div",{css:Object(j.a)(p||(p=Object(O.a)(["\n          background: url(",")  no-repeat center center;\n          backgroundSize: cover;\n          height: 200px;\n          width: 200px;\n        "])),t)}," "))),Object(j.b)(U.a,null,Object(j.b)(A.a,null,h),Object(j.b)(A.a,null,v),Object(j.b)(A.a,null,y),Object(j.b)(A.a,null,C)),Object(j.b)(U.a,null,Object(j.b)(A.a,null,Object(j.b)(f.a,{to:"Edit",state:{user:e.user}},"Edit User Profile")),Object(j.b)(A.a,null,Object(j.b)(f.a,{to:"DegustationSelector"}," Import a degustation")),Object(j.b)(A.a,null,Object(j.b)(f.a,{to:"Degustations"}," View degustations")),Object(j.b)(A.a,null,Object(j.b)(L.a,{onClick:function(e){return function(e){e.preventDefault();var t=window.location.protocol+"//"+window.location.host+"/callback",a="".concat(w.untappdAuthenticateUrl,"?client_id=").concat(encodeURIComponent(w.untappdClientId),"&client_secret=").concat(encodeURIComponent(w.untappdClitntSecret),"&response_type=code&redirect_url=").concat(t);window.location.replace(a)}(e)}},"Populate user data from Untappd"))),Object(j.b)(U.a,null,Object(j.b)(A.a,null,Object(j.b)(L.a,{onClick:function(){m.signOut()}},"Sign out")))))},F=a(661),G=function(e){var t=e.user,a=Object(f.d)(),n=Object(F.parse)(a.search).code;return r.a.createElement(B,{code:n,user:t})},R=function(e){var t=e.user,a=Object(n.useState)(t.email),l=Object(i.a)(a,2),c=l[0],o=l[1],b=Object(n.useState)(t.firstName),m=Object(i.a)(b,2),d=m[0],p=m[1],E=Object(n.useState)(t.lastName),g=Object(i.a)(E,2),h=g[0],v=g[1],O=Object(n.useState)(t.photoURL),j=Object(i.a)(O,2),w=j[0],y=j[1],C=Object(n.useState)(t.untappdName),_=Object(i.a)(C,2),k=_[0],S=_[1],x=Object(n.useState)(null),D=Object(i.a)(x,2),I=D[0],U=D[1],A=function(){var e=Object(s.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,N(t,{firstName:d,lastName:h,photoURL:w,untappdName:k}),e.next=5,Object(f.c)("/");case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),U("Error updating: "+e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),L=function(e){var t=e.currentTarget,a=t.name,n=t.value;"userEmail"===a?o(n):"firstName"===a?p(n):"lastName"===a?v(n):"photoURL"===a?y(n):"untappdName"===a&&S(n)};return r.a.createElement("div",{className:"mt-8"},r.a.createElement("h1",{className:"text-3xl mb-2 text-center font-bold"},"Sign Up"),r.a.createElement("div",{className:"border border-blue-400 mx-auto w-11/12 md:w-2/4 rounded py-8 px-4 md:px-8"},null!==I&&r.a.createElement("div",{className:"py-4 bg-red-600 w-full text-white text-center mb-3"},I),r.a.createElement("form",{className:""},r.a.createElement("label",{htmlFor:"firstName",className:"block"},"First Name:"),r.a.createElement("input",{type:"text",className:"my-1 p-1 w-full ",name:"firstName",value:d,placeholder:"E.g: Eugene",id:"firstName",onChange:function(e){return L(e)}}),r.a.createElement("label",{htmlFor:"lastName",className:"block"},"Last Name:"),r.a.createElement("input",{type:"text",className:"my-1 p-1 w-full ",name:"lastName",value:h,placeholder:"E.g: Sodin",id:"lastName",onChange:function(e){return L(e)}}),r.a.createElement("label",{htmlFor:"userEmail",className:"block"},"Email:"),r.a.createElement("input",{type:"email",className:"my-1 p-1 w-full",name:"userEmail",value:c,placeholder:"E.g: eugene@gmail.com",id:"userEmail",onChange:function(e){return L(e)}}),r.a.createElement("label",{htmlFor:"photoURL",className:"block"},"Photo Url:"),r.a.createElement("input",{type:"text",className:"my-1 p-1 w-full ",name:"photoURL",value:w,id:"lastName",onChange:function(e){return L(e)}}),r.a.createElement("label",{htmlFor:"photoURL",className:"block"},"Untappd Name:"),r.a.createElement("input",{type:"text",className:"my-1 p-1 w-full ",name:"untappdName",value:k,id:"untappdName",onChange:function(e){return L(e)}}),r.a.createElement("button",{className:"bg-green-400 hover:bg-green-500 w-full py-2 text-white",onClick:function(e){A(e)}},"Update"))))},P=a(662),T=a.n(P),W=a(142),V=a(1291),z=a(1292),K=function(e){var t=e.beer,a=e.user,n=e.buttons,l=e.mode,c=null,o=0;if(t.rates&&t.rates.length){var u=t.rates.find((function(e){return e.user===a.uid}));u&&(c=u),o=t.rates.map((function(e){return e.rate})).reduce((function(e,t){return e+Number(t)}),0)/t.rates.length}return r.a.createElement(U.a,{key:t.id,className:"row-cols-10"},r.a.createElement(A.a,{className:"colLabel"},r.a.createElement("img",{className:"beerLabel",src:t.beer.beer_label?t.beer.beer_label:"https://untappd.akamaized.net/site/assets/images/temp/badge-beer-default.png",alt:"Beer label"})),re===l?r.a.createElement(A.a,null,t.beer.bid):"",r.a.createElement(A.a,{className:"colWrap"},t.brewery.brewery_name),r.a.createElement(A.a,{className:"colWrap"},t.beer.beer_name),r.a.createElement(A.a,{className:"colWrap"},t.beer.beer_style),r.a.createElement(A.a,null,t.beer.beer_abv," ",r.a.createElement("br",null)," ",t.beer.beer_ibu),r.a.createElement(A.a,{className:"colWrap"},r.a.createElement(z.a,{key:"overlay"+t.id,placement:"left",delay:{show:250,hide:400},overlay:function(e){return r.a.createElement(V.a,Object.assign({id:"tooltip"+t.id},e),t.beer.beer_description)}},r.a.createElement("div",null,t.beer.beer_description?t.beer.beer_description.substring(0,40)+" ...":""))),r.a.createElement(A.a,null,r.a.createElement(z.a,{key:"shout"+t.id,placement:"left",delay:{show:250,hide:400},overlay:function(e){return r.a.createElement(V.a,Object.assign({id:"shout"+t.id},e),c&&c.shout?c.shout:"--")}},r.a.createElement("div",null,c?c.rate:"--","/",c?Math.round(100*o)/100:"--"))),n.map((function(e){return r.a.createElement(A.a,null,r.a.createElement(L.a,{onClick:e.onClick},e.onClickCaption))})))},q=function(){var e=Object(s.a)(u.a.mark((function e(t,a){var n,r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.a.functions().httpsCallable("getBeerDetailsFromUntappd"),e.next=3,n({bid:a.beer.bid});case 3:if(r=e.sent,!(l=r.data)){e.next=10;break}return t.beers=t.beers.map((function(e){return(e.id&&a.id&&e.id===a.id||e.beer.bid&&a.beer.bid&&e.beer.bid===a.beer.bid)&&(e.brewery=l.brewery,e.beer=Object(y.a)(Object(y.a)({},e.beer),{},{bid:l.bid,beer_abv:l.beer_abv,beer_name:l.beer_name,beer_label:l.beer_label,beer_ibu:l.beer_ibu,beer_description:l.beer_description,beer_style:l.beer_style,rating_score:l.rating_score})),e})),e.next=9,S(t);case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),J=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n,r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.a.functions().httpsCallable("getBeerDetailsFromUntappd"),e.next=3,a({bid:t});case 3:if(!(n=e.sent)||!n.data){e.next=10;break}return r=n.data,(l={}).brewery=r.brewery,l.beer={bid:r.bid,beer_abv:r.beer_abv,beer_name:r.beer_name,beer_label:r.beer_label,beer_ibu:r.beer_ibu,beer_description:r.beer_description,beer_style:r.beer_style,rating_score:r.rating_score},e.abrupt("return",l);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(e,t){return new Promise((function(a,n){e.beer.bid?a([e]):(e.brewery.brewery_name&&e.beer.beer_name||n("Please fill up the brewery name and the beer name"),g.a.functions().httpsCallable("searchBeerOnUntappd")({beer_name:e.beer.beer_name,brewery_name:e.brewery.brewery_name,userId:t.uid}).then((function(t){var r=t.data;r&&0!==r.length?a(r):n("Can't find beer: "+e.brewery.brewery_name+" "+e.beer.beer_name)})))}))},Y=function(e,t,a){return e.sort((function(e,n){return console.log("a",H(e,t)),console.log("b",H(n,t)),H(e,t)<H(n,t)&&"asc"===a?-1:H(e,t)>H(n,t)&&"asc"===a?1:H(e,t)>H(n,t)&&"desc"===a?-1:H(e,t)<H(n,t)&&"desc"===a?1:0}))},H=function(e,t,a){return t.split(/[\.\[\]\'\"]/).filter((function(e){return e})).reduce((function(e,t){return e?e[t]:a}),e)},X=a(1293),Q=function(e){var t=e.degustation,a=e.user,l=e.beer,c=e.refreshBeers,o=e.onClose,u=Object(n.useState)(null),s=Object(i.a)(u,2),b=s[0],m=s[1],d=Object(n.useState)(0),p=Object(i.a)(d,2),f=p[0],E=p[1],h=Object(n.useState)(""),v=Object(i.a)(h,2),O=v[0],j=v[1];return r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title"},b||r.a.createElement("span",null,"Please rate beer ",l.brewery.brewery_name," ",l.beer.beer_name))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("strong",null,"Current rate is ",f),r.a.createElement(X.a,null,r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"range",tooltip:"on",step:.5,min:.5,max:10,value:f,onChange:function(e){E(e.target.value)}}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",value:O,onChange:function(e){j(e.target.value)}}))))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement(L.a,{onClick:function(){m("In progress..."),function(e,t,a,n,r){return g.a.functions().httpsCallable("rateBeer")({degustationId:e.id,beerId:t.id,userId:a.uid,rate:n,shout:r})}(t,l,a,f,O).then((function(){D(t.id).then((function(e){c(e.beers),m(null),o()}))})).catch((function(e){return m("Error: "+e.message)}))}},"Rate!")," ",r.a.createElement(L.a,{onClick:o},"Close"))))},Z=a(68),$=function(e){var t=e.degustation,a=e.refreshBeers,l=e.user,c=Object(n.useState)(null),o=Object(i.a)(c,2),u=o[0],s=o[1],b=Object(n.useState)([]),m=Object(i.a)(b,2),d=m[0],p=m[1],f=Object(n.useState)(!1),E=Object(i.a)(f,2),h=E[0],v=E[1],O=Object(n.useState)(!1),j=Object(i.a)(O,2),w=j[0],C=j[1],N=Object(n.useState)({beerName:"",breweryName:"",beerIbu:0,beerAbv:0,beerStyle:"",beerPlato:0,beerVolume:0,search:""}),_=Object(i.a)(N,2),k=_[0],S=_[1];Object(n.useEffect)((function(){var e=setTimeout((function(){return B()}),500);return function(){return clearTimeout(e)}}),[k.search]);var x=function(){S({beerName:"",breweryName:"",beerIbu:0,beerAbv:0,beerStyle:"",beerPlato:0,beerVolume:0,search:""})},D=function(e){var t,a=e.target,n=a.name,r=a.value;S(Object(y.a)(Object(y.a)({},k),{},Object(Z.a)({},n,r))),t=Object(y.a)(Object(y.a)({},k),{},Object(Z.a)({},n,r)),u.beer.beer_name=t.beerName,u.beer.beer_abv=t.beerAbv,u.beer.beer_ibu=t.beerIbu,u.beer.beer_style=t.beerStyle,u.beer.plato=t.beerPlato,u.volume=t.beerVolume,u.brewery.brewery_name=t.breweryName,s(u)},I=function(){s({id:null,checkin_count:null,volume:null,picture:null,beer:{bid:null,beer_name:null,beer_label:null,beer_abv:null,beer_ibu:null,beer_description:null,beer_style:null,rating:null,plato:null,rating_score:null},brewery:{brewery_id:null,brewery_name:null,brewery_slug:null,brewery_label:null,country_name:null}})};null===u&&I();var B=function(){h||k.search&&k.search.length>3&&(v(!0),isNaN(k.search)?function(e){return new Promise((function(t,a){g.a.functions().httpsCallable("searchOnUntappd")({searchStr:e}).then((function(n){var r=n.data;r&&0!==r.length?t(r):a("Can't find beer: "+e)}))}))}(k.search).then((function(e){p(e),console.log("found beers",e),v(!1)})).catch((function(e){v(!1)})):J(k.search).then((function(e){e&&(p([e]),console.log("found beer",e)),v(!1)})))},F=function(){h||u.beer.beer_name&&u.beer.beer_name.length>3&&u.brewery.brewery_name&&u.brewery.brewery_name.length>3&&(v(!0),M(u).then((function(e){p(e),console.log("found beers",e),v(!1)})).catch((function(e){v(!1)})))};return r.a.createElement("div",null,null!==u?r.a.createElement("div",null,r.a.createElement("h3",null,"Add beer"),r.a.createElement(X.a,null,r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"1"},"Search"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"search",disabled:w,value:k.search,onChange:function(e){return D(e)}}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"1"},"Brewery Name"),r.a.createElement(A.a,{sm:"5"},r.a.createElement(X.a.Control,{type:"text",name:"breweryName",disabled:w,value:k.breweryName,onChange:function(e){D(e);var t=e.target.value;setTimeout((function(){u.brewery.brewery_name===t&&F()}),500)}})),r.a.createElement(X.a.Label,{column:!0,sm:"1"},"Beer Name"),r.a.createElement(A.a,{sm:"5"},r.a.createElement(X.a.Control,{type:"text",name:"beerName",disabled:w,value:k.beerName,onChange:function(e){D(e);var t=e.target.value;setTimeout((function(){u.beer.beer_name===t&&F()}),500)}}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"1"},"Abv"),r.a.createElement(A.a,{sm:"2"},r.a.createElement(X.a.Control,{type:"number",name:"beerAbv",disabled:w,value:k.beerAbv,onChange:D})),r.a.createElement(X.a.Label,{column:!0,sm:"1"},"ibu"),r.a.createElement(A.a,{sm:"2"},r.a.createElement(X.a.Control,{type:"number",name:"beerIbu",disabled:w,value:k.beerIbu,onChange:D})),r.a.createElement(X.a.Label,{column:!0,sm:"1"},"volume"),r.a.createElement(A.a,{sm:"2"},r.a.createElement(X.a.Control,{type:"number",name:"beerVolume",disabled:w,value:k.beerVolume,onChange:D})),r.a.createElement(X.a.Label,{column:!0,sm:"1"},"Plato"),r.a.createElement(A.a,{sm:"2"},r.a.createElement(X.a.Control,{type:"number",name:"beerPlato",disabled:w,value:k.beerPlato,onChange:D}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"1"},"Style"),r.a.createElement(A.a,{sm:"4"},r.a.createElement(X.a.Control,{type:"text",name:"beerStyle",disabled:w,value:k.beerStyle,onChange:D})))),r.a.createElement(L.a,{onClick:function(){u.beer.beer_name&&u.brewery.brewery_name&&(C(!0),t.beers.push(u),console.log("before update",t.beers),q(t,u).then((function(e){a(e.beers),console.log("after update",e.beers),I(),x(),C(!1)})))}},"Add"),r.a.createElement(L.a,{onClick:function(){I(),x()}},"Clear"),d.length>0?r.a.createElement("div",null,r.a.createElement("h4",null," Select a beer"),d.map((function(e){return r.a.createElement(K,{key:e.beer.uid,beer:e,user:l,buttons:[{onClick:function(){s(e),function(e){k.breweryName=e.brewery.brewery_name,k.beerVolume=e.volume,k.beerPlato=e.beer.plato,k.beerStyle=e.beer.beer_style,k.beerAbv=e.beer.beer_abv,k.beerName=e.beer.beer_name,k.beerIbu=e.beer.beer_ibu,S(k)}(e),p([])},onClickCaption:"Select"}],mode:re})}))):""):"")},ee=a(664),te=a(258),ae=a.n(te),ne=(a(388),function(e){var t,a,l=e.degustation,c=Object(n.useState)(!1),o=Object(i.a)(c,2),u=o[0],s=o[1],b=Object(n.useState)(!1),m=Object(i.a)(b,2),d=m[0],p=m[1],f=Object(n.useState)({title:l.title,location:null!==(t=l.location)&&void 0!==t?t:"",avatar:null!==(a=l.avatar)&&void 0!==a?a:"",date:l.date?l.date.seconds?new Date(1e3*l.date.seconds):new Date(l.date):new Date}),E=Object(i.a)(f,2),g=E[0],h=E[1],v=function(e){var t=e.target,a=t.name,n=t.value;h(Object(y.a)(Object(y.a)({},g),{},Object(Z.a)({},a,n)))};return r.a.createElement("div",null,d?r.a.createElement("div",null,r.a.createElement(X.a,null,r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Date"),r.a.createElement(A.a,null,r.a.createElement(ae.a,{selected:g.date,onChange:function(e){h(Object(y.a)(Object(y.a)({},g),{},{date:e}))},disabled:u})),r.a.createElement(A.a,null," "),r.a.createElement(A.a,null," ")),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Title"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"title",value:g.title,onChange:v,disabled:u}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Avatar"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"avatar",value:g.avatar,onChange:v,disabled:u}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Location"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"location",value:g.location,onChange:v,disabled:u})))),r.a.createElement(L.a,{onClick:function(){s(!0),g.date&&(g.date=g.date.toISOString()),S(Object(y.a)(Object(y.a)({},l),g)).then((function(){p(!1),window.location.reload()})).finally((function(){s(!1)}))}},"Save"),r.a.createElement(L.a,{onClick:function(){p(!1)}},"Cancel")):r.a.createElement("div",null,r.a.createElement(L.a,{onClick:function(){p(!0)}},"Degustation Properties")))}),re="edit",le="take_part",ce=function(e){var t=e.user,a=e.degustation,l=e.mode,c=e.sortCurrentDegustationBeers,o=Object(n.useState)(null),b=Object(i.a)(o,2),m=b[0],d=b[1],p=Object(n.useState)([]),f=Object(i.a)(p,2),E=f[0],h=f[1],v=Object(n.useState)(null),O=Object(i.a)(v,2),j=O[0],w=O[1],C=Object(n.useState)(null),N=Object(i.a)(C,2),_=N[0],k=N[1],x=Object(n.useState)([]),D=Object(i.a)(x,2),B=D[0],F=D[1],G=Object(n.useState)(!1),R=Object(i.a)(G,2),P=R[0],T=R[1],V=Object(n.useState)(null),z=Object(i.a)(V,2),J=z[0],Y=z[1],H=Object(n.useState)(a.beers),X=Object(i.a)(H,2),Z=X[0],te=X[1],ae=function(e){if("object"==typeof e){var t=B.findIndex((function(t){return e.id===t.id}));t>=0?(B[t]=e,F(Object(W.a)(B))):(B.push(e),F(Object(W.a)(B)))}},ce=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k("Searching beers on Untappd"),Z.forEach(function(){var e=Object(s.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M(a,t);case 3:(n=e.sent)&&0!==n.length?1===n.length?ae(Object(y.a)({id:a.id},n[0])):E.push(n.map((function(e){return Object(y.a)({id:a.id,originalBeer:a},e)}))):ae(a),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),d(e.t0.message),ae(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(e){console.log("refresh",e),te(Object(W.a)(e))};return Z.length>0&&(console.log("fetching beers details",P),console.log("beers",Z.length),console.log("found beers",B.length),!1===P&&Z.length===B.length&&(T(!0),k("Fetching beer details..."),Promise.all(B.filter((function(e){return e.beer.bid})).map((function(e){return q(a,e).then((function(e){te(e.beers)}))}))).then((function(){F([]),k(null),T(!1)})))),E.length>0&&!j&&(w(E.pop()),h(E)),r.a.createElement("div",null,_?r.a.createElement("div",{className:"mask"},_):"",m?r.a.createElement("div",{className:"error"},m):"",j?r.a.createElement("div",null,r.a.createElement("div",{className:"caption"},r.a.createElement(A.a,null,"Please select a beer")),r.a.createElement("div",{className:"sub-caption"},r.a.createElement(A.a,null,"Original beer"),r.a.createElement(A.a,null,j[0].originalBeer.brewery.brewery_name+" "+j[0].originalBeer.beer.beer_name)),r.a.createElement(I.a,{fluid:!0},r.a.createElement(U.a,null,r.a.createElement(A.a,{className:"colLabel"},"Label"),r.a.createElement(A.a,null,"Untappd ID"),r.a.createElement(A.a,{className:"colWrap"},"Brewery"),r.a.createElement(A.a,{className:"colWrap"},"Beer Name"),r.a.createElement(A.a,{className:"colWrap"},"Style"),r.a.createElement(A.a,null,"ABV ",r.a.createElement("br",null)," IBU"),r.a.createElement(A.a,{className:"colWrap"},"Description"),r.a.createElement(A.a,null,"Rate"),r.a.createElement(A.a,null,"Avg"),r.a.createElement(A.a,null,"Actions")),function(e){return e.map((function(e){return r.a.createElement(K,{key:e.beer.uid,beer:e,user:t,buttons:[{onClick:function(){ae(e),w(null)},onClickCaption:"Select"}],mode:l})}))}(j))):r.a.createElement("div",null,J?r.a.createElement(ee.a,{position:"center center",defaultOpen:!0,open:!!J,closeOnDocumentClick:!1},r.a.createElement(Q,{degustation:a,beer:J,user:t,refreshBeers:oe,onClose:function(){Y(null)}})):"",r.a.createElement("div",{className:"caption"},a.avatar?r.a.createElement("img",{className:"beerLabel",src:a.avatar}):"",r.a.createElement("a",{href:"https://docs.google.com/spreadsheets/d/".concat(a.id,"/edit"),target:"_blank"},"Degustation: ",a.date.seconds?new Date(1e3*a.date.seconds).toDateString():new Date(a.date).toDateString()," ",a.title)),r.a.createElement("div",null,re===l?r.a.createElement("div",null,r.a.createElement(ne,{degustation:a}),r.a.createElement("br",null),r.a.createElement(L.a,{onClick:ce},"Update all beers from untappd"),r.a.createElement(L.a,{onClick:function(){return function(e){return g.a.functions().httpsCallable("exportAllRates")({degustationId:e.id})}(a).then((function(){})).catch((function(){}))}},"Export Rates")):""),re===l?r.a.createElement($,{degustation:a,refreshBeers:oe,user:t}):"",r.a.createElement(I.a,{fluid:!0},r.a.createElement(U.a,{className:"row-cols-10"},r.a.createElement(A.a,{className:"colLabel"},"Label"),re===l?r.a.createElement(A.a,null,"Untappd ID"):"",r.a.createElement(A.a,{className:"colWrap"},"Brewery"),r.a.createElement(A.a,{className:"colWrap"},"Beer Name ",r.a.createElement("div",{center:"true"},r.a.createElement(L.a,{onClick:function(){c("beer.beer_name","asc")}},"Sort"))),r.a.createElement(A.a,{className:"colWrap"},"Style"),r.a.createElement(A.a,null,"ABV ",r.a.createElement("br",null)," IBU ",r.a.createElement("div",{center:"true"},r.a.createElement(L.a,{onClick:function(){c("beer.beer_abv","asc")}},"Sort"))),r.a.createElement(A.a,{className:"colWrap"},"Description"),r.a.createElement(A.a,null,"Rate Your/Avg"),r.a.createElement(A.a,null,"Actions")),Z.map((function(e){var n,c;return re===l?(n=function(){te(function(e,t){return e.beers=e.beers.filter((function(e){return e.id&&t.id?e.id!==t.id:!(!e.beer||!t.beer)&&(e.beer.bid&&t.beer.bid?e.beer.bid!==t.beer.bid:e.beer.name!==t.beer.name)})),S(e),e}(a,e).beers)},c="Delete"):le===l&&(n=function(){Y(e)},c="Rate"),r.a.createElement(K,{key:e.id,beer:e,user:t,buttons:[{onClick:n,onClickCaption:c}],mode:l})}))),re===l?r.a.createElement(L.a,{onClick:function(){k("Exporting degustation data to google sheet"),function(e){return g.a.functions().httpsCallable("saveDegustationToGoogle")({degustation:e})}(a).then((function(){return k(null)}))}},"Export to Google"):""))},oe=(a(742),function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),o=Object(i.a)(c,2),u=o[0],s=o[1],b=Object(n.useState)({location:"",avatar:"",date:new Date}),m=Object(i.a)(b,2),d=m[0],p=m[1],f=function(e){var t=e.target,a=t.name,n=t.value;p(Object(y.a)(Object(y.a)({},d),{},Object(Z.a)({},a,n)))};return r.a.createElement("div",null,u?r.a.createElement("div",null,r.a.createElement(X.a,null,r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Date"),r.a.createElement(A.a,null,r.a.createElement(ae.a,{selected:"string"===typeof d.date?new Date(d.date):d.date,onChange:function(e){p(Object(y.a)(Object(y.a)({},d),{},{date:e}))},disabled:a})),r.a.createElement(A.a,null," "),r.a.createElement(A.a,null," ")),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Title"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"title",value:d.title,onChange:f,disabled:a}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Avatar"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"avatar",value:d.avatar,onChange:f,disabled:a}))),r.a.createElement(X.a.Group,{as:U.a},r.a.createElement(X.a.Label,{column:!0,sm:"2"},"Degustation Location"),r.a.createElement(A.a,null,r.a.createElement(X.a.Control,{type:"text",name:"location",value:d.location,onChange:f,disabled:a})))),r.a.createElement(L.a,{onClick:function(){l(!0),x(d.date instanceof Date?d.date.toISOString():d.date,d.title,d.avatar,d.location).then((function(){s(!1),window.location.reload()})).finally((function(){l(!1)}))}},"Save"),r.a.createElement(L.a,{onClick:function(){s(!1)}},"Cancel")):r.a.createElement("div",null,r.a.createElement(L.a,{onClick:function(){s(!0)}},"New Degustation")))}),ue=function(e){var t=e.user,a=Object(n.useState)(null),l=Object(i.a)(a,2),c=l[0],o=l[1],b=Object(n.useState)(null),m=Object(i.a)(b,2),d=m[0],p=m[1],E=Object(n.useState)(null),h=Object(i.a)(E,2),v=h[0],O=h[1],j=Object(f.e)("/Degustations/:degustationId/:mode");c&&j&&!d&&(p(c.find((function(e){return e.id===j.degustationId}))),O(j.mode)),d&&window.history.replaceState(null,"Degustation ".concat(v),"/Degustations/".concat(d.id,"/").concat(v));return null===c&&k().then((function(e){var t=e.sort((function(e,t){var a=e.date.seconds?new Date(1e3*e.date.seconds):new Date(e.date);return(t.date.seconds?new Date(1e3*t.date.seconds):new Date(t.date))-a}));o(t)})),r.a.createElement("div",null,d?r.a.createElement("div",null,r.a.createElement(ce,{degustation:d,user:t,mode:v,sortCurrentDegustationBeers:function(e,t){if(d){var a=Object(y.a)(Object(y.a)({},d),{},{beers:Y(d.beers,e,t)});p(a),re===v&&S(a)}}}),r.a.createElement(L.a,{onClick:function(){p(null),Object(f.c)("/Degustations")}},"Close")):c?r.a.createElement("div",null,r.a.createElement(oe,null),r.a.createElement("div",{className:"table-action"},r.a.createElement(L.a,{onClick:function(){Object(f.c)("/DegustationSelector")}},"Import degustation")),r.a.createElement(I.a,null,r.a.createElement(U.a,null,r.a.createElement(A.a,null,"Date"),r.a.createElement(A.a,null," Title"),r.a.createElement(A.a,null," Beers count"),r.a.createElement(A.a,null,"Actions")),c.map((function(e){return r.a.createElement(U.a,{key:e.id},r.a.createElement(A.a,null,e.date.seconds?new Date(1e3*e.date.seconds).toDateString():new Date(e.date).toDateString()),r.a.createElement(A.a,null,e.title),r.a.createElement(A.a,null,e.beers.length),r.a.createElement(A.a,null,r.a.createElement(L.a,{onClick:function(){p(e),O(re)}},"Edit")),r.a.createElement(A.a,null,r.a.createElement(L.a,{onClick:Object(s.a)(u.a.mark((function a(){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:g.a.functions().httpsCallable("registerUserForDegustation")({degustationId:e.id,userId:t.uid}).then((function(e){return p(e.data)})),O(le);case 3:case"end":return a.stop()}}),a)})))},"Join degustation")))})))):r.a.createElement("div",null,'"Loading..."'))},se=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(null),o=Object(i.a)(c,2),b=o[0],m=o[1],d=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"picked"===t.action&&(a=t.docs[0],n=g.a.functions().httpsCallable("getDegustationDataFromGoogleSheet"),m("Importing..."),n({id:a.id}).then((function(e){l(Object(y.a)({id:a.id},e.data)),m(null),ue(re)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,b?r.a.createElement("div",null,b):"",r.a.createElement(L.a,{onClick:function(){Object(f.c)("/Degustations")}},"Degustations List"),a?r.a.createElement("div",null,r.a.createElement(L.a,{onClick:function(){Object(f.c)("/DegustationSelector")}},"Import another"),r.a.createElement(ce,{degustation:a,mode:re})):r.a.createElement(T.a,{clientId:w.googleClientId,developerKey:w.googleDeveloperKey,scope:["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/spreadsheets"],onChange:function(e){return d(e)},onAuthFailed:function(e){return console.log("on auth failed:",e)},multiselect:!1,navHidden:!0,authImmediate:!1,mimeTypes:["application/vnd.google-apps.spreadsheet"],query:"\u0414\u0435\u0433\u0443\u0441\u0442\u0430\u0446\u0456\u044f",viewId:"FOLDERS"}))};var ie=function(e){var t=e.user;return t&&t.email?r.a.createElement(f.b,null,r.a.createElement(B,{user:t,path:"/"}),r.a.createElement(R,{user:t,path:"Edit"}),r.a.createElement(se,{path:"DegustationSelector"}),r.a.createElement(ue,{user:t,path:"Degustations"}),r.a.createElement(ue,{user:t,path:"Degustations/:degustationId/:mode"}),r.a.createElement(ce,{user:t,path:"Degustation"}),r.a.createElement(G,{user:t,path:"callback"})):r.a.createElement(f.b,null,r.a.createElement(v,{path:"/"}))},be=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(null),o=Object(i.a)(c,2),b=o[0],d=o[1];return Object(n.useEffect)((function(){m.onAuthStateChanged(function(){var e=Object(s.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===b){e.next=7;break}return d(t),e.next=4,C(t);case 4:a=e.sent,console.log("Token ID changed: ",a),l(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),r.a.createElement("div",null,r.a.createElement(ie,{user:a}))},me=(a(1274),a(1275),a(1276),a(1277),r.a.createElement(be,null));c.a.render(me,document.getElementById("root"))},301:function(e,t){},656:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=656},752:function(e,t){},754:function(e,t){},760:function(e,t){},762:function(e,t){},784:function(e,t){},786:function(e,t){},814:function(e,t){},816:function(e,t){},817:function(e,t){},822:function(e,t){},824:function(e,t){},843:function(e,t){},855:function(e,t){},858:function(e,t){}},[[1278,1,2]]]);
//# sourceMappingURL=main.7ebc4399.chunk.js.map